<!DOCTYPE html>

<html>

<head>
   <meta name="viewport" content="width=device-width, Initial-scale=1">
   <base target="_top">
   <link rel="manifest" href="./manifest.json">
   <link rel="icon" href="./icon.jpg" type="image/x-icon"/>
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '7975217059265570');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=7975217059265570&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->

<body>
   <iframe allow="geolocation *" style="position: Absolute;top: 0;left: 0;width: 100%;height: 100%;border: 0;"
      src="https://script.google.com/macros/s/AKfycbw7n3_cB6uVFihgJhkUGkETqPxVj8gvy0cMFoWPXHggkkypkL-bvIe4qZM8ghgFsI1J/exec"></iframe>
   <script>
      if ('serviceWorker' in navigator) {
         window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service-worker.js').then(registration => {
               console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, err => {
               console.log('ServiceWorker registration failed: ', err);
            });
         });
      }

      let deferredPrompt;

      window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing on mobile
            e.preventDefault();
            // Stash the event so it can be triggered later.
            deferredPrompt = e;

            // Update UI notify the user they can add to home screen
            showInstallPromotion();

            // Optionally, send analytics event that PWA install promo was shown.
            console.log('beforeinstallprompt fired');
        });

      function showInstallPromotion() {
   console.log('show')
         Swal.fire({
            title: 'ติดตั้งแอพลิเคชั่น',
            text: 'คุณสามารถติดตั้งแอพบนมือถือของคุณเพื่อใช้งานได้ดีขึ้น',
            showCancelButton: true,
            confirmButtonText: 'ติดตั้ง',
            cancelButtonText: 'ยกเลิก',
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
         }).then((result) => {
            if (result.isConfirmed) {
               deferredPrompt.prompt();
               // Wait for the user to respond to the prompt
               deferredPrompt.userChoice.then((choiceResult) => {
                  if (choiceResult.outcome === 'accepted') {
                     console.log('User accepted the A2HS prompt');
                  } else {
                     console.log('User dismissed the A2HS prompt');
                  }
                  deferredPrompt = null;
               });
            }
         })
      }

   </script>
</body>

</html>
